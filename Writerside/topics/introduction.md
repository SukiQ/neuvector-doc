# 引言



## 云原生网络安全架构

- 物理机：内外网 + 防火墙 + IPS（入侵防御系统）
- 虚拟机：虚拟网络隔离 + 虚拟防火墙 + Hypervisor
- 云原生：Kubernetes网络策略

<img src="introducation-0.png"  width="700" alt="introducation-0"/>



## 容器安全攻击方式

<img src="introducation-1.png"  width="600" alt="introducation-1"/>

- 易受攻击的程序代码：开发人员编写的应用程序代码及其所依赖的第三方依赖可能包含漏洞，攻击者可以利用它们

- 不当的容器镜像：在**构建容器**镜像时，有很多机会引入漏洞，这些漏洞以后可用于攻击正在运行的容器，包括将容器配置为**特权模式**以 root 用户身份运行等
- 构建机器攻击：如果攻击者可以修改或影响容器镜像的**构建方式**，他们就可以插入恶意代码，随后这些代码将在生产环境中运行
- 供应链攻击：一旦容器镜像构建完成，它就会被存储在注册表中，并在运行时从注册表中检索或拉取。在构建和部署之间能**够替换或修改镜像的用户**可以在已部署等镜像上运行任意代码
- 易受攻击的主机：容器在主机上运行，​​如果主机具有已知**漏洞**的旧版本**编排组件**，则存在被攻击的危险
- 暴露密码：服务代码通常需要凭据、令牌或密码才能与系统中的其他组件进行通信，**不规范的储存和上传**可能会导致密码泄露
- 不安全的网络：容器通常需要与其他容器或外部世界进行通信，攻击者可以利用不安全的**网络策略**，**套件**等方式攻击容器

<note>攻击矩阵详细参照Microsoft提供的 <a href="https://microsoft.github.io/Threat-Matrix-for-Kubernetes/">Kubernetes威胁列表</a></note>



## 容器安全攻击案例

<img src="introducation-2.png"  width="700" alt="introducation-2" thumbnail="true"/>



## 容器安全解决方案

- **单点式**

| 安全领域   | 目标                                 | 工具                                              |
| ---------- | ------------------------------------ | ------------------------------------------------- |
| 镜像安全   | 扫描漏洞、检测恶意软件、确保镜像可信 | `Trivy`, `Clair`, `Notary`                        |
| 运行时安全 | 监测异常进程、系统调用控制           | `Falco`, `Sysdig` `Secure`, `AuditD`              |
| 网络安全   | 保护容器间通信、防止恶意流量         | `Cilium`, `Calico`, `Istio`                       |
| 访问控制   | 限制 Kubernetes 资源访问权限         | `Kubernetes RBAC`, `OPA`, `Vault`                 |
| 合规性检查 | 确保配置符合行业安全标准             | `Kubescape`, `Kube-bench,` `Prometheus + Grafana` |

- **全栈式**

| 平台名称        | 适用场景                                           | 优势                                                        |
| --------------- | -------------------------------------------------- | ----------------------------------------------------------- |
| `Aqua Security` | 适用于企业级 DevSecOps 体系，Kubernetes & 容器安全 | 提供全生命周期安全，支持 CI/CD 集成和云原生环境             |
| `Prisma Cloud`  | 适用于多云环境和企业级安全防护                     | Palo Alto 生态支持，强大的云端可视化与合规管理              |
| `NeuVector`     | 适用于 Kubernetes 集群的运行时安全                 | 实时流量分析，强大的网络安全策略，SUSE 生态支持，**开源的** |